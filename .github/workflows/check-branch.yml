name: Strict Branch Flow
on:
  pull_request:
    branches: [master, develop]

jobs:
  check-flow:
    runs-on: ubuntu-latest
    steps:
      - name: Verify merge order
        run: |
          BASE="${{ github.base_ref }}"
          HEAD="${{ github.head_ref }}"
          
          if [[ "$BASE" == "master" && "$HEAD" != "develop" ]]; then
            echo "에러: master는 develop에서만 머지해라."
            exit 1
          fi
          
          if [[ "$BASE" == "develop" ]]; then
            if [[ "$HEAD" != "ajh" && "$HEAD" != "ksy" && "$HEAD" != "jjw" ]]; then
              echo "에러: develop은 팀원 브랜치(ajh, ksy, jjw)에서만 머지해라."
              exit 1
            fi
          fi